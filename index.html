<index2.html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>魂の犬種診断 - 16タイプ相性テスト</title>
    <style>
        /* CSS: 見た目を整えます */
        body { font-family: 'Hiragino Kaku Gothic Pro', 'メイリオ', Meiryo, sans-serif; max-width: 700px; margin: 30px auto; padding: 25px; background-color: #f7f7f7; border: 1px solid #ddd; border-radius: 10px; }
        h1 { color: #5a5a7a; text-align: center; border-bottom: 3px double #d0d0d0; padding-bottom: 15px; margin-bottom: 30px; font-size: 1.8em; }
        .question-section { margin-bottom: 25px; padding: 15px; background-color: #fff; border: 1px solid #e0e0e0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .question-label { display: block; margin-bottom: 15px; font-weight: bold; color: #333; font-size: 1.1em; }
        .option-group { margin-bottom: 10px; display: flex; align-items: center; }
        input[type="radio"] { margin-right: 10px; }
        button { padding: 12px 25px; background-color: #5a5a7a; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1.1em; width: 100%; transition: background-color 0.3s; }
        button:hover { background-color: #7a7a9a; }
        #result { margin-top: 30px; padding: 25px; border: 2px solid #5a5a7a; border-radius: 10px; background-color: #ffffff; box-shadow: 0 5px 15px rgba(0,0,0,0.1); display: none; }
        .type-name { font-size: 1.8em; font-weight: 900; margin-bottom: 10px; color: #d04040; text-align: center; }
        .affinity-result { font-size: 1.4em; font-weight: bold; margin-top: 20px; padding-top: 15px; border-top: 1px dashed #ccc; text-align: center; }
        .detail-text { margin-top: 15px; line-height: 1.8; color: #333; }
        .input-name { padding: 8px; border: 1px solid #ccc; border-radius: 4px; margin-bottom: 20px; width: 97%; }
    </style>
</head>
<body>

<h1>🐶 魂の犬種診断 - 16タイプ相性テスト</h1>

<div id="quiz-area">
    <div class="input-group">
        <label for="user-name">あなたの名前（診断結果に表示されます）:</label>
        <input type="text" id="user-name" class="input-name" placeholder="例: LaLaLa">
    </div>

    <div class="question-section">
        <p class="question-label">Q1 (E/I): 他の犬が集まっている場所を見たら？</p>
        <div class="option-group"><input type="radio" name="q1" value="E" required> 1. すぐに駆けつける</div>
        <div class="option-group"><input type="radio" name="q1" value="I"> 2. 遠くから様子を伺う</div>
    </div>
    <div class="question-section">
        <p class="question-label">Q2 (E/I): 家で一人の時間、どう過ごしたい？</p>
        <div class="option-group"><input type="radio" name="q2" value="E" required> 1. 寂しくて誰かを呼ぶ</div>
        <div class="option-group"><input type="radio" name="q2" value="I"> 2. 自分の時間を満喫する</div>
    </div>
    <div class="question-section">
        <p class="question-label">Q3 (S/N): 新しいおもちゃをもらったら？</p>
        <div class="option-group"><input type="radio" name="q3" value="S" required> 1. 噛み心地や構造をじっくり確かめる</div>
        <div class="option-group"><input type="radio" name="q3" value="N"> 2. どうやって遊べるか色々な可能性を想像する</div>
    </div>
    <div class="question-section">
        <p class="question-label">Q4 (S/N): 散歩のルートについて</p>
        <div class="option-group"><input type="radio" name="q4" value="S" required> 1. 毎回同じ道の隅々までチェックする</div>
        <div class="option-group"><input type="radio" name="q4" value="N"> 2. 新しい道を探求し、ワクワクする</div>
    </div>
    <div class="question-section">
        <p class="question-label">Q5 (T/F): 飼い主を怒らせた時、まず何を考える？</p>
        <div class="option-group"><input type="radio" name="q5" value="T" required> 1. なぜ怒られたか原因を論理的に分析する</div>
        <div class="option-group"><input type="radio" name="q5" value="F"> 2. 飼い主の悲しい感情を察知し、慰める</div>
    </div>
    <div class="question-section">
        <p class="question-label">Q6 (T/F): 友達の犬が喧嘩：</p>
        <div class="option-group"><input type="radio" name="q6" value="T" required> 1. どちらが間違っているか冷静に見極める</div>
        <div class="option-group"><input type="radio" name="q6" value="F"> 2. 仲裁に入り、平和を優先する</div>
    </div>
    <div class="question-section">
        <p class="question-label">Q7 (J/P): ご飯の時間について</p>
        <div class="option-group"><input type="radio" name="q7" value="J" required> 1. 決められた時間にきっちり欲しい</div>
        <div class="option-group"><input type="radio" name="q7" value="P"> 2. お腹が空いた時に自由にもらいたい</p>
    </div>

    <button id="diagnose-button">あなたの魂の犬種を診断！</button>
</div>

<div id="result" style="display:none;">
    <h2 style="text-align: center; color: #5a5a7a;">あなたの魂の犬種は...</h2>
    <p class="type-name" id="diagnosed-name"></p>
    <p style="text-align: center; font-style: italic;" id="dog-type-catchphrase"></p>
    <div class="detail-text" id="dog-type-detail"></div>

    <div class="affinity-result" id="affinity-section" style="display: none;">
        <h3 style="color: #d04040;">🐕 二人の相性をチェック！</h3>
        <p style="font-size: 0.9em; margin-bottom: 10px;">相手の結果コードを入力してください (例: ENFP)</p>
        <input type="text" id="partner-code" class="input-name" placeholder="相手の診断結果コード (例: ISTJ)">
        <button id="affinity-button">相性診断</button>
        <p id="affinity-result-text" style="margin-top: 15px; font-weight: normal;"></p>
    </div>
    <button id="reset-button" style="margin-top: 20px; background-color: #ccc; color: #333;">もう一度診断する</button>
</div>

<script>
// ----------------------------------------------------
// JavaScript (診断ロジック) - 最終検証版
// ----------------------------------------------------

const DOG_TYPES = {
    // 16タイプ定義 (簡略表示)
    "ISTJ": { name: "ドーベルマン", catchphrase: "規律を重んじる論理的な守護犬", detail: "あなたの魂は、揺るぎない忠誠心と論理的な思考で成り立っています。信頼した相手には鉄壁の安心感を与える、遅咲きの愛を育みます。", affinity: ["ENFP", "ISFP", "ESTP"], conflict: ["INFP", "ENFJ"] },
    "ESTJ": { name: "ジャーマン・シェパード", catchphrase: "生まれながらのリーダー、統率の犬", detail: "群れをまとめ上げる天性の統率力と、現実的な問題解決能力を持っています。家族や仲間を現実的に支えることに喜びを感じます。", affinity: ["ISFP", "INFP", "ESTJ"], conflict: ["INFJ", "ENTP"] },
    "ISTP": { name: "ジャック・ラッセル・テリア", catchphrase: "瞬発力と好奇心の独立者", detail: "常に身体を動かし、五感で世界を理解する探検家です。ルールや計画に縛られることを嫌い、予測不能な状況でも冷静に対処します。", affinity: ["ESFJ", "ISTP", "ENTP"], conflict: ["ENFJ", "INFJ"] },
    "ESTP": { name: "ボクサー", catchphrase: "場の空気を変える行動派パフォーマー", detail: "その場を楽しむことに全力を注ぐ生粋のエンターテイナーです。理論よりも行動を優先し、その圧倒的な行動力が魅力です。", affinity: ["ISTJ", "ISFP", "ESFP"], conflict: ["INFP", "INTJ"] },
    "INFP": { name: "チワワ", catchphrase: "静かに世界を想う理想の詩人", detail: "内向的で繊細、自分の内面世界を何よりも大切にするロマンチストです。現実よりも理想を追求し、大切な人には深く共感します。", affinity: ["ENFJ", "ENTP", "INFP"], conflict: ["ESTJ", "ESTP"] },
    "ENFP": { name: "ゴールデン・レトリバー", catchphrase: "無限の愛を配る太陽の犬", detail: "際限のない好奇心と前向きな感情で輝いています。論理よりも「共感」と「楽しさ」を優先します。ムードメーカーの役割で群れに活力を与えます。", affinity: ["ISTJ", "INFJ", "ENTJ"], conflict: ["ISTP", "ESTP"] },
    "INFJ": { name: "柴犬", catchphrase: "静かな洞察力を持つ、魂の参謀", detail: "他者の感情を深く読み取る洞察力と、揺るぎない信念を持つ理想家です。心を開くまでに時間がかかり、孤独を愛します。", affinity: ["ENFP", "ENTP", "INFJ"], conflict: ["ESTJ", "ESTP"] },
    "ENFJ": { name: "ラブラドール・レトリバー", catchphrase: "群れを導く、究極の調和主義者", detail: "感情の機微を察知し、群れ全体の幸福を最優先する天性の指導者です。愛情深く、献身的なパートナーになります。", affinity: ["INFP", "INTJ", "ENFJ"], conflict: ["ISTP", "ESTP"] },
    "INTJ": { name: "ロットワイラー", catchphrase: "合理性を追求する孤高の戦略家", detail: "感情を排除した絶対的な合理性と、未来を見通す計画性に支配されています。無駄や非効率を嫌い、長期的な安全と安定を提供します。", affinity: ["ENFJ", "ENTP", "INFP"], conflict: ["ESFP", "ESTP"] },
    "ENTJ": { name: "ワイマラナー", catchphrase: "目標達成の鬼、圧倒的推進力", detail: "常に目標達成のために集団を動かします。優れた論理と強い意志を持ち、効率的な成果を求める指揮官です。", affinity: ["INFP", "INTJ", "ENTJ"], conflict: ["ISFP", "ESFP"] },
    "INTP": { name: "アフガン・ハウンド", catchphrase: "知識の探求者、論理の芸術家", detail: "世界がどう動いているのか、その原理を解明することに喜びを感じます。内向的で、自分の思考を整理する時間を重視。", affinity: ["ESFJ", "ENTP", "INTP"], conflict: ["ESTJ", "ESFP"] },
    "ENTP": { name: "プードル", catchphrase: "議論を楽しむ、知的な変革者", detail: "好奇心の赴くままに行動し、常に新しい可能性を探る知的な遊び人です。独創的で多才ですが、一つのことに長く集中するのは苦手。", affinity: ["ISTJ", "INFJ", "ENFP"], conflict: ["ISFJ", "ESFJ"] },
    "ISFJ": { name: "キャバリア", catchphrase: "群れの調和を守る、献身的な介護者", detail: "群れの平和と秩序を守ることに存在意義を見出します。細部まで気を配り、他者のニーズを察知して行動する「癒やし」の存在です。", affinity: ["ESFP", "ISTP", "ISFJ"], conflict: ["ENTP", "INTJ"] },
    "ESFJ": { name: "マルチーズ", catchphrase: "社交的な女王、愛情表現の達人", detail: "社交的で、誰に対してもオープンに愛情を表現します。共感力が高く、群れの中で誰も孤独にならないよう常に気を配る、社交界のスターです。", affinity: ["ISTP", "INTP", "ESFP"], conflict: ["ENTP", "INTJ"] },
    "ISFP": { name: "パグ", catchphrase: "マイペースな芸術家、五感の表現者", detail: "自分の感情と五感を最優先し、独自の美的感覚に従って行動します。他者の意見に流されず、自由と個性を重んじます。", affinity: ["ESTJ", "ENTJ", "ISFP"], conflict: ["ENFJ", "INFJ"] },
    "ESFP": { name: "ダルメシアン", catchphrase: "注目を集める、エネルギッシュなスター", detail: "あなたは生まれながらのパフォーマーであり、注目を集めることで活力を得ます。瞬間的な感情と楽しさを追求します。", affinity: ["ISTP", "ISFJ", "ESTP"], conflict: ["INTJ", "ENTJ"] }
};

function determineCode() {
    const answers = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };
    let allAnswered = true;

    // 質問チェックロジック（7問）
    for (let i = 1; i <= 7; i++) {
        const checked = document.querySelector(`input[name="q${i}"]:checked`);
        if (!checked) {
            allAnswered = false;
            break; // 1つでも未回答があればループ終了
        }
        answers[checked.value]++;
    }

    if (!allAnswered) { return null; } // 未回答があればnullを返す
    
    // 軸ごとの判定
    const axis1 = answers.E >= answers.I ? 'E' : 'I';
    const axis2 = answers.S >= answers.N ? 'S' : 'N';
    const axis3 = answers.T >= answers.F ? 'T' : 'F';
    const axis4 = answers.J >= answers.P ? 'J' : 'P';

    return axis1 + axis2 + axis3 + axis4;
}

function diagnose() {
    const code = determineCode();
    const userName = document.getElementById('user-name').value || 'あなた';
    
    if (code === null) {
        // 未回答の場合、アラートを表示して処理を停止
        alert("⚠️ すべての質問に回答してください。");
        return; 
    }

    const typeData = DOG_TYPES[code];
    
    // 結果表示エリアへの書き込み
    document.getElementById('diagnosed-name').innerText = `${userName}さんの魂の犬種は...【${typeData.name}】`;
    document.getElementById('dog-type-catchphrase').innerText = typeData.catchphrase;
    document.getElementById('dog-type-detail').innerHTML = `<p><strong>【${typeData.name}の核心】</strong></p><p>${typeData.detail}</p>`;
    
    // 表示の切り替え
    document.getElementById('quiz-area').style.display = 'none';
    document.getElementById('result').style.display = 'block';
    
    localStorage.setItem('myDogType', code); // 結果コードを保存
    document.getElementById('affinity-section').style.display = 'block';
}

function checkAffinity() {
    const myCode = localStorage.getItem('myDogType');
    const partnerCode = document.getElementById('partner-code').value.toUpperCase().trim();
    const resultText = document.getElementById('affinity-result-text');

    if (!partnerCode || !DOG_TYPES[partnerCode]) {
        resultText.innerHTML = '<span style="color:red;">⚠️ 相手のコードを正しく入力してください (例: ENFP)</span>';
        return;
    }

    const myType = DOG_TYPES[myCode];
    const partnerType = DOG_TYPES[partnerCode];
    let affinityMessage = "";
    
    // 相性判定ロジック
    if (myType.affinity.includes(partnerCode)) {
        affinityMessage = `<span style="color: #d04040;">奇跡のコンビネーション！</span><br>お互いの**欠点**を補い合い、**長所**を最大限に伸ばす、運命的なパートナーです。`;
    } else if (myType.conflict.includes(partnerCode)) {
        affinityMessage = `<span style="color: #333;">激突のコントラスト...</span><br>価値観が真逆なため、衝突しやすい関係です。`;
    } else if (myCode === partnerCode) {
        affinityMessage = `<span style="color: #008000;">共鳴する盟友！</span><br>同じ魂の犬種なので、言葉以上に理解し合えます。`;
    } else {
        affinityMessage = `<span style="color: #4682b4;">穏やかな連携。</span><br>大きな問題もなく、無理なく付き合える良好な関係です。`;
    }

    resultText.innerHTML = `<strong>${myType.name}</strong> と <strong>${partnerType.name}</strong> の相性は：<br>${affinityMessage}`;
}

function resetQuiz() {
    // 表示とフォームのリセット
    document.getElementById('quiz-area').style.display = 'block';
    document.getElementById('result').style.display = 'none';
    document.getElementById('affinity-section').style.display = 'none';
    document.getElementById('partner-code').value = '';
    document.getElementById('affinity-result-text').innerHTML = '';
    
    document.getElementById('user-name').value = '';
    document.querySelectorAll('input[type="radio"]').forEach(radio => radio.checked = false);
    localStorage.removeItem('myDogType');
}

// ページが完全に読み込まれた後に関数をボタンに割り当てる
document.addEventListener('DOMContentLoaded', function() {
    resetQuiz(); 
    document.getElementById('diagnose-button').addEventListener('click', diagnose);
    document.getElementById('affinity-button').addEventListener('click', checkAffinity);
    document.getElementById('reset-button').addEventListener('click', resetQuiz);
});
</script>
</body>
</html>